<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calibration of P-Values for Point Null Hypothesis Testing • pcal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Calibration of P-Values for Point Null Hypothesis Testing">
<meta property="og:description" content="Calibrate p-values under a robust perspective and obtain measures of 
    the evidence provided by the data in favor of point null hypotheses which are safer  
    and more straightforward to interpret.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-169641497-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169641497-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">pcal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pedro-teles-fonseca/pcal/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="pcal-calibration-of-p-values-for-point-null-hypothesis-testing" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#pcal-calibration-of-p-values-for-point-null-hypothesis-testing" class="anchor"></a>pcal: Calibration of P-Values for Point Null Hypothesis Testing</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>P-values are the most commonly used tool to measure the evidence provided by the data against a model or hypothesis. Unfortunately, p-values are often incorrectly interpreted as the probability that the null hypothesis is true or as type I error probabilities. The <code>pcal</code> package uses the calibrations developed in Sellke et al (2001) to calibrate p-values under a robust perspective and obtain measures of the evidence provided by the data in favor of point null hypotheses which are safer and more straightforward interpret:</p>
<ul>
<li><p><code><a href="reference/pcal.html">pcal()</a></code> calibrates p-values so that they can be directly interpreted as either lower bounds on the posterior probabilities of point null hypotheses or as lower bounds on type I error probabilities. With this calibration one need not fear the misinterpretation of a type I error probability as the probability that the null hypothesis is true because they coincide. Note that the output of this calibration has both Bayesian and Frequentist interpretations.</p></li>
<li><p><code><a href="reference/bcal.html">bcal()</a></code> calibrates p-values so that they can be interpreted as lower bounds on Bayes factors in favor of point null hypotheses.</p></li>
</ul>
<p>Some utility functions are also included:</p>
<ul>
<li><p><code><a href="reference/bfactor_to_prob.html">bfactor_to_prob()</a></code> turns Bayes factors into posterior probabilities using a formula from Berger and Delampady (1987)</p></li>
<li><p><code><a href="reference/bfactor_interpret.html">bfactor_interpret()</a></code> classifies the strength of the evidence implied by a Bayes factor according to the scale suggested by Jeffreys (1961).</p></li>
<li><p><code><a href="reference/bfactor_interpret_kr.html">bfactor_interpret_kr()</a></code> classifies the strength of the evidence implied by a Bayes factor according to an alternative scale suggested by Kass and Raftery (1995)</p></li>
<li><p><code><a href="reference/bfactor_log_interpret.html">bfactor_log_interpret()</a></code> is similar to <code><a href="reference/bfactor_interpret.html">bfactor_interpret()</a></code> but takes logarithms of Bayes factors as input</p></li>
<li><p><code><a href="reference/bfactor_log_interpret_kr.html">bfactor_log_interpret_kr()</a></code> is similar to <code><a href="reference/bfactor_interpret_kr.html">bfactor_interpret_kr()</a></code> but takes logarithms of Bayes factors as input</p></li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><code>pcal</code> is not yet on CRAN but it can be installed from GitHub using the <code>devtools</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># install.packages("devtools")</span>
<span class="kw">devtools</span>::<span class="fu">install_github</span>(<span class="st">"pedro-teles-fonseca/pcal"</span>)
</pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>First we need a p-value from any statistical test of a point null hypothesis, for example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">13</span>, <span class="fl">14</span>), ncol = <span class="fl">2</span>)
<span class="kw">pv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span>(<span class="kw">x</span>)[[<span class="st">"p.value"</span>]]
</pre></div>
<p>With <code><a href="reference/bcal.html">bcal()</a></code> we can turn <code>pv</code> into a lower bound for the Bayes factor in favor of the null hypothesis:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="reference/bcal.html">bcal</a></span>(<span class="kw">pv</span>)
<span class="co"># [1] 0.009641104</span>
</pre></div>
<p>We can also turn <code>pv</code> into a lower bound for the posterior probability of the null hypothesis using <code><a href="reference/pcal.html">pcal()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="reference/pcal.html">pcal</a></span>(<span class="kw">pv</span>)
<span class="co"># [1] 0.009549041</span>
</pre></div>
<p>This is an approximation to the minimum posterior probability of the null hypothesis that we would find by changing the prior distribution of the parameter of interest (under the alternative hypothesis) over wide classes of distributions. The output of <code><a href="reference/bcal.html">bcal()</a></code> has an analogous interpretation for Bayes factors (instead of posterior probabilities).</p>
<p>One can avoid the specification of prior probabilities for the hypothesis by focusing solely on Bayes factors. To compute posterior probabilities for the hypotheses, however, prior probabilities must by specified. By default, <code><a href="reference/pcal.html">pcal()</a></code> assigns a prior probability of 0.5 to the null hypothesis. We can specify different prior probabilities, for example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">pcal</span>(pv, <span class="dt">prior_prob =</span> <span class="fl">.95</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>[<span class="dv">1</span>] <span class="fl">0.1548208</span></span></code></pre></div>
<p>In this case we obtain a higher lower bound because the null hypothesis has a higher prior probability.</p>
<p>Since the output of <code><a href="reference/bcal.html">bcal(pv)</a></code> is a Bayes factor, we can use <code><a href="reference/bfactor_to_prob.html">bfactor_to_prob()</a></code> to turn it into a posterior probability:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="reference/bfactor_to_prob.html">bfactor_to_prob</a></span>(<span class="fu"><a href="reference/bcal.html">bcal</a></span>(<span class="kw">pv</span>)) <span class="co"># same as pcal(pv)</span>
<span class="co"># [1] 0.009549041</span>
</pre></div>
<p>Like <code><a href="reference/pcal.html">pcal()</a></code>, <code>bfactor_to_prob</code> assumes a prior probability of 0.5 to the null hypothesis. We can change this default:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">bfactor_to_prob</span>(<span class="kw">bcal</span>(pv), <span class="dt">prior_prob =</span> <span class="fl">.95</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>[<span class="dv">1</span>] <span class="fl">0.1548208</span></span></code></pre></div>
<p>To classify the strength of the evidence in favor of the null hypothesis implied by a Bayes factor we can use <code><a href="reference/bfactor_interpret.html">bfactor_interpret()</a></code> :</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">bfactor_interpret</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">150</span>))</span>
<span id="cb8-2"><a href="#cb8-2"></a>[<span class="dv">1</span>] <span class="st">"Negative"</span> <span class="st">"Weak"</span> <span class="st">"Substantial"</span> <span class="st">"Strong"</span> <span class="st">"Very Strong"</span> <span class="st">"Decisive"</span> </span></code></pre></div>
<p>Alternatively, we can use <code>bfactor_interpret()_kr</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">bfactor_interpret_kr</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">150</span>))</span>
<span id="cb9-2"><a href="#cb9-2"></a>[<span class="dv">1</span>] <span class="st">"Negative"</span> <span class="st">"Weak"</span> <span class="st">"Positive"</span> <span class="st">"Strong"</span> <span class="st">"Strong"</span> <span class="st">"Very Strong"</span></span></code></pre></div>
<p>Because Bayes factors are often reported on a logarithmic scale, there are also <code>bfactor_log_interpret</code> and <code>bfactor_log_interpret_kr</code> functions that interpret the logarithms of Bayes factors:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>bfs &lt;-<span class="st"> </span><span class="kw">log10</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">150</span>))</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw">bfactor_log_interpret</span>(bfs, <span class="dt">base =</span> <span class="dv">10</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>[<span class="dv">1</span>] <span class="st">"Negative"</span> <span class="st">"Weak"</span> <span class="st">"Substantial"</span> <span class="st">"Strong"</span> <span class="st">"Very Strong"</span> <span class="st">"Decisive"</span>  </span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw">bfactor_log_interpret_kr</span>(bfs, <span class="dt">base =</span> <span class="dv">10</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a>[<span class="dv">1</span>] <span class="st">"Negative"</span> <span class="st">"Weak"</span> <span class="st">"Positive"</span> <span class="st">"Strong"</span> <span class="st">"Strong"</span> <span class="st">"Very Strong"</span></span></code></pre></div>
<p>To compare the results with those from standard likelihood ratio tests it can be useful to obtain the strength of the evidence against the null hypothesis. If <code>bf</code> is a Bayes factor in favor of the null hypothesis, one can use <code>1/bf</code> as input to obtain the strength of the evidence against the null hypothesis:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Evidence in favor of the null hypothesis</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">bfactor_interpret</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">150</span>))</span>
<span id="cb11-3"><a href="#cb11-3"></a>[<span class="dv">1</span>] <span class="st">"Negative"</span> <span class="st">"Weak"</span> <span class="st">"Substantial"</span> <span class="st">"Strong"</span> <span class="st">"Very Strong"</span> <span class="st">"Decisive"</span>   </span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># Evidence against the null hypothesis</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="kw">bfactor_interpret</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">150</span>))</span>
<span id="cb11-7"><a href="#cb11-7"></a>[<span class="dv">1</span>] <span class="st">"Weak"</span> <span class="st">"Negative"</span> <span class="st">"Negative"</span> <span class="st">"Negative"</span> <span class="st">"Negative"</span> <span class="st">"Negative"</span></span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li><p>Berger JO, Delampady M (1987). “Testing precise hypotheses.” Statistical Science, 2(3), 317–335.</p></li>
<li><p>Jeffreys H (1961). Theory of probability, Oxford Classic Texts In The Phisical Sciences, 3 edition. Oxford University Press.</p></li>
<li><p>Kass RE, Raftery AE (1995). “Bayes factors.” Journal of the American Statistical Association, 90(430), 773–795.</p></li>
<li><p>Sellke T, Bayarri MJ, Berger JO (2001). “Calibration of p values for testing precise null hypotheses.” The American Statistician, 55(1), 62–71.</p></li>
</ul>
</div>
<div id="getting-help" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-help" class="anchor"></a>Getting Help</h2>
<p>If you find a bug, please file an issue with a minimal reproducible example on <a href="https://github.com/pedro-teles-fonseca/pcal/issues">GitHub</a>. Feature requests are also welcome. You can contact me at <a href="mailto:pedro.teles.fonseca@outlook.com" class="email">pedro.teles.fonseca@outlook.com</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/pedro-teles-fonseca/pcal/">https://​github.com/​pedro-teles-fonseca/​pcal/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/pedro-teles-fonseca/pcal/issues">https://​github.com/​pedro-teles-fonseca/​pcal/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing pcal</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Pedro Fonseca <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-5708-081X" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>FCT <br><small class="roles"> Funder </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/pedro-teles-fonseca/pcal"><img src="https://travis-ci.org/pedro-teles-fonseca/pcal.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://github.com/pedro-teles-fonseca/pcal/actions"><img src="https://github.com/pedro-teles-fonseca/pcal/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/pedro-teles-fonseca/pcal"><img src="https://codecov.io/gh/pedro-teles-fonseca/pcal/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Pedro Fonseca, FCT.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
