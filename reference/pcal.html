<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Lower Bounds on Posterior Probabilities for Point Null Hypotheses — pcal • pcal</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Lower Bounds on Posterior Probabilities for Point Null Hypotheses — pcal" />
<meta property="og:description" content="Calibrate p-values under a robust perspective so that they can
be directly interpreted as either lower bounds on the posterior probabilities
of point null hypotheses or lower bounds on the probabilities of type I
errors." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169641497-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169641497-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pcal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pedro-teles-fonseca/pcal/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Lower Bounds on Posterior Probabilities for Point Null Hypotheses</h1>
    <small class="dont-index">Source: <a href='https://github.com/pedro-teles-fonseca/pcal/blob/master/R/p-calibrations.R'><code>R/p-calibrations.R</code></a></small>
    <div class="hidden name"><code>pcal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calibrate p-values under a robust perspective so that they can
be directly interpreted as either lower bounds on the posterior probabilities
of point null hypotheses or lower bounds on the probabilities of type I
errors.</p>
    </div>

    <pre class="usage"><span class='fu'>pcal</span>(<span class='kw'>p</span>, prior_prob = <span class='fl'>0.5</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>p</th>
      <td><p>A numeric vector with values in the [0,1] interval.</p></td>
    </tr>
    <tr>
      <th>prior_prob</th>
      <td><p>A numeric vector with values in the [0,1] interval.
If <code>length(p) == 1</code> then <code>prior_prob</code> can be of any positive
<code><a href='https://rdrr.io/r/base/length.html'>length</a></code>, but if <code>length(p) &gt; 1</code> then the
<code><a href='https://rdrr.io/r/base/length.html'>length</a></code> of <code>prior_prob</code> can only be <code>1</code> or equal to the
<code><a href='https://rdrr.io/r/base/length.html'>length</a></code> of <code>p</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>length(p) &gt; 1</code> then <code>pcal</code> returns a numeric vector
with the same <code><a href='https://rdrr.io/r/base/length.html'>length</a></code> as <code>p</code>, otherwise it returns
a numeric vector with the same <code><a href='https://rdrr.io/r/base/length.html'>length</a></code> as <code>prior_prob</code>.
Warning messages are thrown if there are <code>NA</code> or <code>NaN</code> values in <code>p</code>
or in <code>prior_prob</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>pcal</code> is a vectorized implementation of the calibration of p-values
into lower bounds for the posterior probabilities of point null hypotheses
(or lower bounds for the probabilities of type I errors) developed by
Sellke et al. (2001)
. The calibration is:
$$
      \alpha(p) = (1 + \lbrack -e \,  p log(p) \rbrack^{-1})^{-1}
      $$
where \(p\) is a  p-value on a classical test statistic. This
calibration assumes that both the null and the alternative hypotheses have
0.5 prior probability. We generalized the aforementioned calibration for
prior probabilities other than 0.5:
$$
      \alpha(p) = \left(
         1 + \frac{1 - \pi_0}{\pi_0} \, \lbrack -e \,  p log(p) \rbrack^{-1}
      \right)^{-1}
      $$
where \(\pi_0\) is the prior probability of the null hypothesis
and \(1 - \pi_0\) is the prior probability of the alternative
hypothesis.</p>
<p>For each element of <code>p</code>, <code>pcal</code> returns an  approximation of the smallest
posterior probability of the null hypothesis that is found by changing the
prior distribution of the parameter of interest (under the alternative
hypothesis) over wide classes of distributions.  Alternatively, the output
of <code>pcal</code> can also be interpreted as lower bounds on the probabilities of
type I errors, which means that this calibration has both Bayesian and
Frequentist interpretations. Sellke et al. (2001)

noted that a scenario in which they definitely recommend this calibration
is when investigating fit to the null model with no explicit alternative
in mind. Pericchi and Torres (2011)
 warn that despite
the usefulness and appropriateness of this p-value calibration it does not
depend on sample size, and hence the lower bounds obtained with large
samples may be conservative.</p>
<p>The <code>prior_prob</code> argument is optional and is set to 0.5 by default,
implying prior equiprobability of hypotheses. <code>prior_prob</code> can only be
of <code><a href='https://rdrr.io/r/base/length.html'>length</a></code> equal to  the <code>length</code> of <code>p</code>, in which
case each prior probability in <code>prior_prob</code> is used in the calibration
of the corresponding element of <code>p</code>, or of <code><a href='https://rdrr.io/r/base/length.html'>length</a></code> <code>1</code>,
in which case it will be recycled (if <code>length(p) &gt; 1</code>) and the same
<code>prior_prob</code> value is used in the calibration of all the elements of <code>p</code>.</p>
<p>Note that <code>pcal(p, prior_prob)</code> is equivalent to
<code><a href='bfactor_to_prob.html'>bfactor_to_prob</a>(<a href='bcal.html'>bcal</a>(p), prior_prob)</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Pericchi L, Torres D (2011).
&#8220;Quick anomaly detection by the Newcomb—Benford law, with applications to electoral processes data from the USA, Puerto Rico and Venezuela.&#8221;
<em>Statistical Science</em>, <b>26</b>(4), 502--516.<br /><br /> Sellke T, Bayarri MJ, Berger JO (2001).
&#8220;Calibration of p values for testing precise null hypotheses.&#8221;
<em>The American Statistician</em>, <b>55</b>(1), 62--71.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p><code><a href='bcal.html'>bcal</a></code> for a p-value calibration that returns lower
bounds on Bayes factors in favor of point null hypotheses.</p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Calibration of a typical "threshold" p-value:</span>
<span class='co'>#----------------------------------------------</span>
<span class='fu'>pcal</span>(<span class='fl'>.05</span>)
</div><div class='output co'>#&gt; [1] 0.2893499</div><div class='input'>
<span class='co'># Calibration of typical "threshold" p-values:</span>
<span class='co'>#---------------------------------------------</span>
<span class='fu'>pcal</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>, <span class='fl'>.05</span>, <span class='fl'>.01</span>, <span class='fl'>.005</span>, <span class='fl'>.001</span>))
</div><div class='output co'>#&gt; [1] 0.38495887 0.28934989 0.11125450 0.06717427 0.01843114</div><div class='input'>
<span class='co'># Application: chi-squared goodness-of-fit test,</span>
<span class='co'># lower bound on the posterior probability of the null hypothesis:</span>
<span class='co'>#-----------------------------------------------------------------</span>
<span class='kw'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>18</span>, <span class='fl'>12</span>, <span class='fl'>10</span>, <span class='fl'>12</span>, <span class='fl'>10</span>, <span class='fl'>23</span>), ncol = <span class='fl'>2</span>)
<span class='fu'>pcal</span>(<span class='fu'><a href='https://rdrr.io/r/stats/chisq.test.html'>chisq.test</a></span>(<span class='kw'>data</span>)[[<span class='st'>"p.value"</span>]])
</div><div class='output co'>#&gt; [1] 0.273104</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pedro Fonseca, FCT.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


